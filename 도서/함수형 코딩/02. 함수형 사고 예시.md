# 2. 현실에서의 함수형 사고

피자 가게 예시에 함수형 사고 적용.

함수형 사고

1. 액션 / 계산 / 데이터 구분
	- 계층형 설계 (stratified design)
2. 일급 추상 
	- Timeline diagram : 분산 시스템을 이해하기 위함
	- First-class function : 함수를 인자로 받는 함수

## 1. 액션 / 계산 / 데이터 구분

* 액션 : 호출 시점 / 횟수에 의존
	* 피자 배달
	* 재료 주문
* 계산 : 실행해도 다른 곳에 영향 주지 X. 여러 번 실행해도 괜찮음
	* 재료 주문 목록 결정
* 데이터 : Immutable. 다양하게 사용 가능
	* 고객 주문
	* 조리법

### 계층화 설계

**변경 가능성에 따라 코드를 나눔.**

**비즈니스 규칙, 도메인 규칙, 기술 스택 계층으로 나눔.** == '변경 가능성에 따라 코드를 나눔'

⬆️ 자주 바뀜 (**아래 계층에 의존**). 자주 안 바뀌는 것을 기반으로 하기 때문에 안정적.
⬇️ 자주 안 바뀜

|주방 layer|창고 layer|Main layer|
|-|-|-|
|오늘의 메뉴|오늘 사야할 재료|비즈니스 규칙|
|조리법 순서|재료 목록에 대한 동작|도메인 규칙|
|프로그램 코딩 언어|프로그램 코딩 언어|기술 스택|

장점 : **코드 쉽게 변경 가능. 테스트, 재사용, 유지보수 쉬움.**

## 2. 일급 추상

### 타임라인 다이어그램

**액션이 시간 순서에 따라 어떻게 실행되는지 파악 가능. (액션은 실행 순서가 중요!)**

<img width="543" alt="image" src="https://github.com/Yoojin99/100-Days-of-SwiftUI-Practice/assets/41438361/97a31ad7-e5b3-46d5-96b6-625bee5b5b1b">

### 분산 시스템을 타임라인으로 시각화

**분산 시스템에서 독립된 액션의 실행 순서는 보장 안됨.** (어떤 액션이 먼저 실행되리라는 보장 없음)

순차 시스템을 분산 시스템으로 바꾸기 위해서는 액션의 순서가 중요.

<img width="774" alt="image" src="https://github.com/Yoojin99/100-Days-of-SwiftUI-Practice/assets/41438361/e260f0e1-56d8-4b13-996f-92a902d763e8">

**각 타임라인은 다른 순서로 실행됨** ➡️ **분산 시스템이 예측 불가능한 순서로 실행됨**

<img width="753" alt="image" src="https://github.com/Yoojin99/100-Days-of-SwiftUI-Practice/assets/41438361/d7847f23-e67a-4030-8ab5-7a9ea5f282ee">

## 타임라인 커팅

**Timeline Cutting : 여러 타임라인이 동시에 진행될 때 순서를 맞추는 방법. High-order operation (고차 동작)으로 구현.**

<img width="778" alt="image" src="https://github.com/Yoojin99/100-Days-of-SwiftUI-Practice/assets/41438361/c1ceb2ea-a908-4e60-b3b9-df87053867f8">

Cut : 모든 작업이 끝날 때까지 진행하지 말라는 선.

➡️ 어떤 타임라인이 먼저 끝나도 상관 없음. 작업이 먼저 끝나면 아직 끝나지 않은 다른 타임라인을 기다림.

1. 타임라인 내 액션의 실행 순서를 맞춰야 함
2. 액션이 실행되는 시간(소요 시간)은 중요 X
3. 타임라인 다이어그램으로 시스템의 문제 파악 가능 (e.g. 반죽 펴기 전에 반죽이 준비되지 않았다는 문제)
	* 타임라인 커팅으로 실행 순서에 상관없이 이해
	* 타임라인 다이어그램은 분산 시스템을 시각화하기 좋음
	* 타임라인 다이어그램은 유연. 다이어그램으로 모델링 쉬움.

## 정리

* FP 프로그래머에게 가장 중요한 것은 액션 / 계산 / 데이터를 구분하는 일.
* 유지보수를 위해 계층형 설계를 사용. 계층형 설계에서 각 계층은 변경 가능성에 따라 나뉨.
* 타임라인 다이어그램은 시간에 따라 변하는 액션을 시각화.
* 액션 간 협력을 위해 타임라인 커팅 사용 가능. 커팅을 통해 액션이 올바른 순서에 따라 실행되도록 보장.
